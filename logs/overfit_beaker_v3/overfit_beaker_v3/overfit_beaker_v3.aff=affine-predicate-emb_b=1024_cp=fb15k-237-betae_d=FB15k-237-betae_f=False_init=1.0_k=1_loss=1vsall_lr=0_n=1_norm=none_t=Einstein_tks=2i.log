2022-07-31 20:43:55,422 INFO     ---------------------------------------------------------------------------------------------
2022-07-31 20:43:55,422 INFO     Geo: cqd
2022-07-31 20:43:55,422 INFO     Data Path: data/FB15k-237-betae
2022-07-31 20:43:55,422 INFO     #entity: 14505
2022-07-31 20:43:55,422 INFO     #relation: 474
2022-07-31 20:43:55,423 INFO     #max steps: 150000
2022-07-31 20:43:55,423 INFO     Evaluate unoins using: DNF
2022-07-31 20:43:55,423 INFO     loading data
2022-07-31 20:44:32,304 INFO     Training info:
2022-07-31 20:44:32,307 INFO     2i: 149689
2022-07-31 20:44:32,903 INFO     Validation info:
2022-07-31 20:44:32,904 INFO     2i: 5000
2022-07-31 20:44:32,905 INFO     Test info:
2022-07-31 20:44:32,905 INFO     2i: 5000
2022-07-31 20:44:35,677 INFO     Model Parameter Configuration:
2022-07-31 20:44:35,677 INFO     Parameter embeddings.0.weight: torch.Size([14505, 2000]), require_grad = True
2022-07-31 20:44:35,677 INFO     Parameter embeddings.1.weight: torch.Size([474, 2000]), require_grad = True
2022-07-31 20:44:35,677 INFO     Parameter score_transform_fun.weight: torch.Size([2, 2000]), require_grad = True
2022-07-31 20:44:35,677 INFO     Parameter score_transform_fun.bias: torch.Size([2]), require_grad = True
2022-07-31 20:44:35,677 INFO     Parameter Number: 29962002
2022-07-31 20:44:35,712 INFO     Loading checkpoint models/fb15k-237-betae...
2022-07-31 20:44:36,673 INFO     tasks = 2i
2022-07-31 20:44:36,673 INFO     init_step = 99999
2022-07-31 20:44:36,673 INFO     Start Training...
2022-07-31 20:44:36,673 INFO     learning_rate = 0
2022-07-31 20:44:36,673 INFO     batch_size = 1024
2022-07-31 20:44:36,673 INFO     hidden_dim = 1000
2022-07-31 20:44:36,673 INFO     gamma = 12.000000
2022-07-31 20:44:43,446 INFO     Evaluating on Valid Dataset...
posix.uname_result(sysname='Linux', nodename='gonzo-605-3.local', release='3.10.0-1160.49.1.el7.x86_64', version='#1 SMP Tue Nov 30 15:51:32 UTC 2021', machine='x86_64')
  0%|          | 0/5000 [00:00<?, ?it/s]2022-07-31 20:44:44,362 INFO     Evaluating the model... (0/5000)
  1%|          | 27/5000 [00:00<00:18, 267.47it/s]  1%|          | 59/5000 [00:00<00:16, 297.03it/s]  2%|▏         | 90/5000 [00:00<00:16, 298.76it/s]  2%|▏         | 122/5000 [00:00<00:15, 306.33it/s]  3%|▎         | 154/5000 [00:00<00:15, 310.79it/s]  4%|▎         | 186/5000 [00:00<00:15, 307.61it/s]  4%|▍         | 218/5000 [00:00<00:15, 310.89it/s]  5%|▌         | 250/5000 [00:00<00:15, 303.19it/s]  6%|▌         | 281/5000 [00:00<00:16, 293.13it/s]  6%|▌         | 312/5000 [00:01<00:15, 297.54it/s]  7%|▋         | 344/5000 [00:01<00:15, 301.94it/s]  8%|▊         | 376/5000 [00:01<00:15, 304.56it/s]  8%|▊         | 408/5000 [00:01<00:14, 306.89it/s]  9%|▉         | 439/5000 [00:01<00:14, 306.19it/s]  9%|▉         | 471/5000 [00:01<00:14, 308.46it/s] 10%|█         | 506/5000 [00:01<00:14, 319.04it/s] 11%|█         | 542/5000 [00:01<00:13, 328.90it/s] 12%|█▏        | 581/5000 [00:01<00:12, 344.40it/s] 12%|█▏        | 620/5000 [00:01<00:12, 355.71it/s] 13%|█▎        | 656/5000 [00:02<00:12, 354.01it/s] 14%|█▍        | 694/5000 [00:02<00:11, 361.06it/s] 15%|█▍        | 732/5000 [00:02<00:11, 365.56it/s] 15%|█▌        | 769/5000 [00:02<00:11, 362.89it/s] 16%|█▌        | 808/5000 [00:02<00:11, 368.51it/s] 17%|█▋        | 845/5000 [00:02<00:11, 367.49it/s] 18%|█▊        | 882/5000 [00:02<00:11, 363.23it/s] 18%|█▊        | 921/5000 [00:02<00:11, 368.64it/s] 19%|█▉        | 958/5000 [00:02<00:11, 363.56it/s] 20%|█▉        | 997/5000 [00:02<00:10, 368.67it/s] 21%|██        | 1036/5000 [00:03<00:10, 372.34it/s] 21%|██▏       | 1074/5000 [00:03<00:10, 365.74it/s] 22%|██▏       | 1112/5000 [00:03<00:10, 369.50it/s] 23%|██▎       | 1149/5000 [00:03<00:10, 369.42it/s] 24%|██▎       | 1186/5000 [00:03<00:10, 362.12it/s] 24%|██▍       | 1225/5000 [00:03<00:10, 367.50it/s] 25%|██▌       | 1262/5000 [00:03<00:10, 367.06it/s] 26%|██▌       | 1299/5000 [00:03<00:10, 360.91it/s] 27%|██▋       | 1337/5000 [00:03<00:10, 365.48it/s] 28%|██▊       | 1375/5000 [00:04<00:09, 368.69it/s] 28%|██▊       | 1412/5000 [00:04<00:09, 363.07it/s] 29%|██▉       | 1450/5000 [00:04<00:09, 366.93it/s] 30%|██▉       | 1487/5000 [00:04<00:09, 366.67it/s] 30%|███       | 1524/5000 [00:04<00:09, 362.70it/s] 31%|███▏      | 1563/5000 [00:04<00:09, 368.02it/s] 32%|███▏      | 1600/5000 [00:04<00:09, 364.04it/s] 33%|███▎      | 1638/5000 [00:04<00:09, 368.56it/s] 34%|███▎      | 1677/5000 [00:04<00:08, 372.44it/s] 34%|███▍      | 1715/5000 [00:04<00:08, 366.34it/s] 35%|███▌      | 1753/5000 [00:05<00:08, 368.93it/s] 36%|███▌      | 1791/5000 [00:05<00:08, 371.82it/s] 37%|███▋      | 1829/5000 [00:05<00:08, 366.27it/s] 37%|███▋      | 1868/5000 [00:05<00:08, 370.69it/s] 38%|███▊      | 1906/5000 [00:05<00:08, 371.50it/s] 39%|███▉      | 1944/5000 [00:05<00:08, 367.87it/s] 40%|███▉      | 1983/5000 [00:05<00:08, 371.84it/s] 40%|████      | 2021/5000 [00:05<00:08, 366.22it/s] 41%|████      | 2060/5000 [00:05<00:07, 370.67it/s] 42%|████▏     | 2099/5000 [00:05<00:07, 373.84it/s] 43%|████▎     | 2137/5000 [00:06<00:07, 363.83it/s] 44%|████▎     | 2176/5000 [00:06<00:07, 368.83it/s] 44%|████▍     | 2215/5000 [00:06<00:07, 372.21it/s] 45%|████▌     | 2253/5000 [00:06<00:07, 366.66it/s] 46%|████▌     | 2291/5000 [00:06<00:07, 369.41it/s] 47%|████▋     | 2328/5000 [00:06<00:07, 366.82it/s] 47%|████▋     | 2366/5000 [00:06<00:07, 368.27it/s] 48%|████▊     | 2405/5000 [00:06<00:06, 372.21it/s] 49%|████▉     | 2443/5000 [00:06<00:06, 365.58it/s] 50%|████▉     | 2482/5000 [00:07<00:06, 370.19it/s] 50%|█████     | 2521/5000 [00:07<00:06, 373.73it/s] 51%|█████     | 2559/5000 [00:07<00:06, 367.31it/s] 52%|█████▏    | 2598/5000 [00:07<00:06, 371.39it/s] 53%|█████▎    | 2637/5000 [00:07<00:06, 374.27it/s] 54%|█████▎    | 2675/5000 [00:07<00:06, 367.11it/s] 54%|█████▍    | 2714/5000 [00:07<00:06, 371.21it/s] 55%|█████▌    | 2752/5000 [00:07<00:06, 373.38it/s] 56%|█████▌    | 2790/5000 [00:07<00:06, 363.93it/s] 57%|█████▋    | 2829/5000 [00:07<00:05, 368.78it/s] 57%|█████▋    | 2866/5000 [00:08<00:05, 365.73it/s] 58%|█████▊    | 2904/5000 [00:08<00:05, 367.82it/s] 59%|█████▉    | 2943/5000 [00:08<00:05, 371.75it/s] 60%|█████▉    | 2981/5000 [00:08<00:05, 366.28it/s] 60%|██████    | 3020/5000 [00:08<00:05, 370.82it/s] 61%|██████    | 3059/5000 [00:08<00:05, 374.25it/s] 62%|██████▏   | 3097/5000 [00:08<00:05, 367.87it/s] 63%|██████▎   | 3135/5000 [00:08<00:05, 369.25it/s] 63%|██████▎   | 3173/5000 [00:08<00:04, 369.90it/s] 64%|██████▍   | 3211/5000 [00:08<00:04, 364.03it/s] 65%|██████▍   | 3249/5000 [00:09<00:04, 367.71it/s] 66%|██████▌   | 3286/5000 [00:09<00:04, 365.91it/s] 66%|██████▋   | 3323/5000 [00:09<00:04, 366.33it/s] 67%|██████▋   | 3361/5000 [00:09<00:04, 369.85it/s] 68%|██████▊   | 3399/5000 [00:09<00:04, 363.77it/s] 69%|██████▊   | 3437/5000 [00:09<00:04, 366.46it/s] 70%|██████▉   | 3475/5000 [00:09<00:04, 370.41it/s] 70%|███████   | 3513/5000 [00:09<00:04, 364.68it/s] 71%|███████   | 3552/5000 [00:09<00:03, 369.50it/s] 72%|███████▏  | 3591/5000 [00:10<00:03, 372.71it/s] 73%|███████▎  | 3629/5000 [00:10<00:03, 366.72it/s] 73%|███████▎  | 3668/5000 [00:10<00:03, 371.38it/s] 74%|███████▍  | 3706/5000 [00:10<00:03, 372.38it/s] 75%|███████▍  | 3744/5000 [00:10<00:03, 367.31it/s] 76%|███████▌  | 3782/5000 [00:10<00:03, 370.47it/s] 76%|███████▋  | 3820/5000 [00:10<00:03, 367.90it/s] 77%|███████▋  | 3857/5000 [00:10<00:03, 368.37it/s] 78%|███████▊  | 3896/5000 [00:10<00:02, 372.37it/s] 79%|███████▊  | 3934/5000 [00:10<00:02, 366.50it/s] 79%|███████▉  | 3972/5000 [00:11<00:02, 370.31it/s] 80%|████████  | 4011/5000 [00:11<00:02, 373.72it/s] 81%|████████  | 4049/5000 [00:11<00:02, 367.75it/s] 82%|████████▏ | 4087/5000 [00:11<00:02, 370.10it/s] 82%|████████▎ | 4125/5000 [00:11<00:02, 372.18it/s] 83%|████████▎ | 4163/5000 [00:11<00:02, 365.57it/s] 84%|████████▍ | 4201/5000 [00:11<00:02, 368.88it/s] 85%|████████▍ | 4239/5000 [00:11<00:02, 370.70it/s] 86%|████████▌ | 4277/5000 [00:11<00:01, 365.07it/s] 86%|████████▋ | 4315/5000 [00:11<00:01, 367.82it/s] 87%|████████▋ | 4352/5000 [00:12<00:01, 365.54it/s] 88%|████████▊ | 4390/5000 [00:12<00:01, 367.70it/s] 89%|████████▊ | 4428/5000 [00:12<00:01, 370.91it/s] 89%|████████▉ | 4466/5000 [00:12<00:01, 365.66it/s] 90%|█████████ | 4504/5000 [00:12<00:01, 368.79it/s] 91%|█████████ | 4541/5000 [00:12<00:01, 369.15it/s] 92%|█████████▏| 4578/5000 [00:12<00:01, 364.34it/s] 92%|█████████▏| 4616/5000 [00:12<00:01, 368.40it/s] 93%|█████████▎| 4655/5000 [00:12<00:00, 372.04it/s] 94%|█████████▍| 4693/5000 [00:13<00:00, 332.24it/s] 95%|█████████▍| 4728/5000 [00:13<00:00, 297.00it/s] 95%|█████████▌| 4759/5000 [00:13<00:00, 292.82it/s] 96%|█████████▌| 4793/5000 [00:13<00:00, 303.92it/s] 96%|█████████▋| 4825/5000 [00:13<00:00, 308.13it/s] 97%|█████████▋| 4857/5000 [00:13<00:00, 309.98it/s] 98%|█████████▊| 4891/5000 [00:13<00:00, 316.34it/s] 98%|█████████▊| 4923/5000 [00:13<00:00, 312.90it/s] 99%|█████████▉| 4957/5000 [00:13<00:00, 318.57it/s]100%|█████████▉| 4991/5000 [00:14<00:00, 323.77it/s]100%|██████████| 5000/5000 [00:14<00:00, 355.79it/s]
2022-07-31 20:44:58,411 INFO     Valid 2i MRR at step 100000: 0.003451
2022-07-31 20:44:58,411 INFO     Valid 2i HITS1 at step 100000: 0.000400
2022-07-31 20:44:58,411 INFO     Valid 2i HITS3 at step 100000: 0.001000
2022-07-31 20:44:58,411 INFO     Valid 2i HITS10 at step 100000: 0.002400
2022-07-31 20:44:58,411 INFO     Valid 2i num_queries at step 100000: 5000.000000
2022-07-31 20:44:58,411 INFO     Valid average MRR at step 100000: 0.003451
2022-07-31 20:44:58,411 INFO     Valid average HITS1 at step 100000: 0.000400
2022-07-31 20:44:58,411 INFO     Valid average HITS3 at step 100000: 0.001000
2022-07-31 20:44:58,411 INFO     Valid average HITS10 at step 100000: 0.002400
2022-07-31 20:44:58,411 INFO     Evaluating on Test Dataset...
  0%|          | 0/5000 [00:00<?, ?it/s]2022-07-31 20:44:58,415 INFO     Evaluating the model... (0/5000)
  1%|          | 30/5000 [00:00<00:16, 298.61it/s]  1%|▏         | 64/5000 [00:00<00:15, 320.54it/s]  2%|▏         | 97/5000 [00:00<00:15, 316.57it/s]  3%|▎         | 130/5000 [00:00<00:15, 319.31it/s]  3%|▎         | 164/5000 [00:00<00:14, 325.06it/s]  4%|▍         | 197/5000 [00:00<00:15, 317.17it/s]  5%|▍         | 231/5000 [00:00<00:14, 323.27it/s]  5%|▌         | 264/5000 [00:00<00:14, 325.06it/s]  6%|▌         | 297/5000 [00:00<00:14, 317.09it/s]  7%|▋         | 331/5000 [00:01<00:14, 322.70it/s]  7%|▋         | 365/5000 [00:01<00:14, 326.74it/s]  8%|▊         | 398/5000 [00:01<00:14, 319.01it/s]  9%|▊         | 432/5000 [00:01<00:14, 323.93it/s]  9%|▉         | 465/5000 [00:01<00:13, 325.22it/s] 10%|▉         | 498/5000 [00:01<00:14, 319.65it/s] 11%|█         | 532/5000 [00:01<00:13, 324.33it/s] 11%|█▏        | 565/5000 [00:01<00:13, 318.83it/s] 12%|█▏        | 598/5000 [00:01<00:13, 321.51it/s] 13%|█▎        | 632/5000 [00:01<00:13, 325.58it/s] 13%|█▎        | 665/5000 [00:02<00:13, 317.66it/s] 14%|█▍        | 699/5000 [00:02<00:13, 322.70it/s] 15%|█▍        | 733/5000 [00:02<00:13, 325.96it/s] 15%|█▌        | 766/5000 [00:02<00:13, 318.22it/s] 16%|█▌        | 800/5000 [00:02<00:12, 323.35it/s] 17%|█▋        | 833/5000 [00:02<00:12, 321.69it/s] 17%|█▋        | 866/5000 [00:02<00:12, 318.32it/s] 18%|█▊        | 900/5000 [00:02<00:12, 323.34it/s] 19%|█▊        | 933/5000 [00:02<00:12, 315.61it/s] 19%|█▉        | 967/5000 [00:03<00:12, 321.28it/s] 20%|██        | 1001/5000 [00:03<00:12, 325.64it/s] 21%|██        | 1034/5000 [00:03<00:12, 318.08it/s] 21%|██▏       | 1068/5000 [00:03<00:12, 323.25it/s] 22%|██▏       | 1102/5000 [00:03<00:11, 325.39it/s] 23%|██▎       | 1135/5000 [00:03<00:12, 319.32it/s] 23%|██▎       | 1169/5000 [00:03<00:11, 324.31it/s] 24%|██▍       | 1202/5000 [00:03<00:11, 317.45it/s] 25%|██▍       | 1236/5000 [00:03<00:11, 322.74it/s] 25%|██▌       | 1270/5000 [00:03<00:11, 326.15it/s] 26%|██▌       | 1303/5000 [00:04<00:11, 318.28it/s] 27%|██▋       | 1337/5000 [00:04<00:11, 323.18it/s] 27%|██▋       | 1371/5000 [00:04<00:11, 326.78it/s] 28%|██▊       | 1404/5000 [00:04<00:11, 317.45it/s] 29%|██▉       | 1438/5000 [00:04<00:11, 322.65it/s] 29%|██▉       | 1471/5000 [00:04<00:11, 320.63it/s] 30%|███       | 1504/5000 [00:04<00:10, 320.26it/s] 31%|███       | 1538/5000 [00:04<00:10, 324.96it/s] 31%|███▏      | 1571/5000 [00:04<00:10, 317.56it/s] 32%|███▏      | 1605/5000 [00:04<00:10, 322.78it/s] 33%|███▎      | 1639/5000 [00:05<00:10, 326.57it/s] 33%|███▎      | 1672/5000 [00:05<00:10, 318.54it/s] 34%|███▍      | 1706/5000 [00:05<00:10, 322.11it/s] 35%|███▍      | 1739/5000 [00:05<00:10, 319.71it/s] 35%|███▌      | 1772/5000 [00:05<00:10, 318.46it/s] 36%|███▌      | 1806/5000 [00:05<00:09, 323.59it/s] 37%|███▋      | 1839/5000 [00:05<00:09, 316.80it/s] 37%|███▋      | 1873/5000 [00:05<00:09, 321.89it/s] 38%|███▊      | 1907/5000 [00:05<00:09, 325.61it/s] 39%|███▉      | 1940/5000 [00:06<00:10, 295.52it/s] 39%|███▉      | 1971/5000 [00:06<00:10, 297.30it/s] 40%|████      | 2002/5000 [00:06<00:10, 299.39it/s] 41%|████      | 2034/5000 [00:06<00:09, 303.91it/s] 41%|████▏     | 2066/5000 [00:06<00:09, 307.98it/s] 42%|████▏     | 2098/5000 [00:06<00:09, 308.90it/s] 43%|████▎     | 2130/5000 [00:06<00:09, 309.95it/s] 43%|████▎     | 2166/5000 [00:06<00:08, 322.45it/s] 44%|████▍     | 2201/5000 [00:06<00:08, 329.87it/s] 45%|████▍     | 2239/5000 [00:06<00:08, 344.43it/s] 46%|████▌     | 2277/5000 [00:07<00:07, 354.78it/s] 46%|████▋     | 2313/5000 [00:07<00:07, 353.91it/s] 47%|████▋     | 2349/5000 [00:07<00:21, 126.08it/s] 48%|████▊     | 2376/5000 [00:08<00:18, 138.85it/s] 48%|████▊     | 2401/5000 [00:08<00:16, 154.97it/s] 49%|████▊     | 2427/5000 [00:08<00:14, 172.56it/s] 49%|████▉     | 2452/5000 [00:08<00:13, 187.23it/s] 50%|████▉     | 2477/5000 [00:08<00:12, 200.74it/s] 50%|█████     | 2502/5000 [00:08<00:11, 211.54it/s] 51%|█████     | 2527/5000 [00:08<00:11, 221.14it/s] 51%|█████     | 2555/5000 [00:08<00:10, 235.92it/s] 52%|█████▏    | 2588/5000 [00:08<00:09, 261.38it/s] 52%|█████▏    | 2618/5000 [00:08<00:08, 271.37it/s] 53%|█████▎    | 2652/5000 [00:09<00:08, 289.32it/s] 54%|█████▎    | 2686/5000 [00:09<00:07, 302.69it/s] 54%|█████▍    | 2717/5000 [00:09<00:07, 301.45it/s] 55%|█████▌    | 2751/5000 [00:09<00:07, 311.40it/s] 56%|█████▌    | 2785/5000 [00:09<00:06, 318.51it/s] 56%|█████▋    | 2818/5000 [00:09<00:07, 299.46it/s] 57%|█████▋    | 2849/5000 [00:09<00:07, 285.07it/s] 58%|█████▊    | 2878/5000 [00:09<00:07, 272.27it/s] 58%|█████▊    | 2912/5000 [00:09<00:07, 289.29it/s] 59%|█████▉    | 2946/5000 [00:10<00:06, 302.22it/s] 60%|█████▉    | 2977/5000 [00:10<00:06, 301.17it/s] 60%|██████    | 3011/5000 [00:10<00:06, 310.95it/s] 61%|██████    | 3044/5000 [00:10<00:06, 316.13it/s] 62%|██████▏   | 3076/5000 [00:10<00:06, 311.60it/s] 62%|██████▏   | 3110/5000 [00:10<00:05, 318.44it/s] 63%|██████▎   | 3143/5000 [00:10<00:05, 320.34it/s] 64%|██████▎   | 3176/5000 [00:10<00:05, 317.01it/s] 64%|██████▍   | 3210/5000 [00:10<00:05, 321.41it/s] 65%|██████▍   | 3243/5000 [00:10<00:05, 310.47it/s] 66%|██████▌   | 3275/5000 [00:11<00:05, 311.73it/s] 66%|██████▌   | 3307/5000 [00:11<00:05, 313.27it/s] 67%|██████▋   | 3339/5000 [00:11<00:05, 311.58it/s] 67%|██████▋   | 3371/5000 [00:11<00:05, 313.26it/s] 68%|██████▊   | 3403/5000 [00:11<00:05, 314.50it/s] 69%|██████▊   | 3435/5000 [00:11<00:05, 312.76it/s] 69%|██████▉   | 3471/5000 [00:11<00:04, 325.52it/s] 70%|███████   | 3508/5000 [00:11<00:04, 335.70it/s] 71%|███████   | 3545/5000 [00:11<00:04, 344.13it/s] 72%|███████▏  | 3583/5000 [00:11<00:04, 353.43it/s] 72%|███████▏  | 3619/5000 [00:12<00:03, 351.09it/s] 73%|███████▎  | 3657/5000 [00:12<00:03, 358.30it/s] 74%|███████▍  | 3695/5000 [00:12<00:03, 363.66it/s] 75%|███████▍  | 3732/5000 [00:12<00:03, 359.43it/s] 75%|███████▌  | 3770/5000 [00:12<00:03, 365.45it/s] 76%|███████▌  | 3809/5000 [00:12<00:03, 370.03it/s] 77%|███████▋  | 3847/5000 [00:12<00:03, 364.29it/s] 78%|███████▊  | 3885/5000 [00:12<00:03, 368.81it/s] 78%|███████▊  | 3922/5000 [00:12<00:02, 367.96it/s] 79%|███████▉  | 3959/5000 [00:13<00:02, 366.05it/s] 80%|███████▉  | 3998/5000 [00:13<00:02, 370.40it/s] 81%|████████  | 4036/5000 [00:13<00:02, 365.12it/s] 81%|████████▏ | 4074/5000 [00:13<00:02, 368.90it/s] 82%|████████▏ | 4112/5000 [00:13<00:02, 371.59it/s] 83%|████████▎ | 4150/5000 [00:13<00:02, 365.23it/s] 84%|████████▍ | 4189/5000 [00:13<00:02, 369.60it/s] 85%|████████▍ | 4227/5000 [00:13<00:02, 372.58it/s] 85%|████████▌ | 4265/5000 [00:13<00:02, 364.49it/s] 86%|████████▌ | 4303/5000 [00:13<00:01, 368.79it/s] 87%|████████▋ | 4341/5000 [00:14<00:01, 368.98it/s] 88%|████████▊ | 4378/5000 [00:14<00:01, 366.78it/s] 88%|████████▊ | 4416/5000 [00:14<00:01, 370.44it/s] 89%|████████▉ | 4454/5000 [00:14<00:01, 373.19it/s] 90%|████████▉ | 4492/5000 [00:14<00:01, 366.69it/s] 91%|█████████ | 4531/5000 [00:14<00:01, 370.83it/s] 91%|█████████▏| 4569/5000 [00:14<00:01, 370.80it/s] 92%|█████████▏| 4607/5000 [00:14<00:01, 368.21it/s] 93%|█████████▎| 4645/5000 [00:14<00:00, 371.28it/s] 94%|█████████▎| 4683/5000 [00:14<00:00, 366.46it/s] 94%|█████████▍| 4721/5000 [00:15<00:00, 368.15it/s] 95%|█████████▌| 4759/5000 [00:15<00:00, 370.32it/s] 96%|█████████▌| 4797/5000 [00:15<00:00, 364.18it/s] 97%|█████████▋| 4835/5000 [00:15<00:00, 367.29it/s] 97%|█████████▋| 4873/5000 [00:15<00:00, 370.84it/s] 98%|█████████▊| 4911/5000 [00:15<00:00, 361.01it/s] 99%|█████████▉| 4949/5000 [00:15<00:00, 365.52it/s]100%|█████████▉| 4987/5000 [00:15<00:00, 368.03it/s]100%|██████████| 5000/5000 [00:15<00:00, 315.67it/s]
2022-07-31 20:45:14,253 INFO     Test 2i MRR at step 100000: 0.003597
2022-07-31 20:45:14,253 INFO     Test 2i HITS1 at step 100000: 0.000200
2022-07-31 20:45:14,253 INFO     Test 2i HITS3 at step 100000: 0.000600
2022-07-31 20:45:14,253 INFO     Test 2i HITS10 at step 100000: 0.003200
2022-07-31 20:45:14,253 INFO     Test 2i num_queries at step 100000: 5000.000000
2022-07-31 20:45:14,253 INFO     Test average MRR at step 100000: 0.003597
2022-07-31 20:45:14,253 INFO     Test average HITS1 at step 100000: 0.000200
2022-07-31 20:45:14,253 INFO     Test average HITS3 at step 100000: 0.000600
2022-07-31 20:45:14,253 INFO     Test average HITS10 at step 100000: 0.003200
2022-07-31 20:45:14,253 INFO     Training average positive_sample_loss at step 100000: 10132.714355
2022-07-31 20:45:14,253 INFO     Training average negative_sample_loss at step 100000: 10132.714355
2022-07-31 20:45:14,253 INFO     Training average loss at step 100000: 10132.714355
/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in DivBackward0. Traceback of forward call that caused the error:
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 543, in main
    log = KGReasoning.train_step(model, optimizer, train_other_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 674, in train_step
    model.forward(positive_sample=positive_sample,
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/cqd/base.py", line 451, in forward
    scores = d2.query_2i(entity_embeddings=self.embeddings[0],
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/cqd/discrete.py", line 182, in query_2i
    res = t_norm(scores_1, scores_2)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torchnorms/tnorms/classic.py", line 63, in __call__
    return (a * b) / (1.0 + (1.0 - a) * (1.0 - b))
 (Triggered internally at  ../torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Traceback (most recent call last):
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 543, in main
    log = KGReasoning.train_step(model, optimizer, train_other_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 931, in train_step
    loss.backward()
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'DivBackward0' returned nan values in its 0th output.
