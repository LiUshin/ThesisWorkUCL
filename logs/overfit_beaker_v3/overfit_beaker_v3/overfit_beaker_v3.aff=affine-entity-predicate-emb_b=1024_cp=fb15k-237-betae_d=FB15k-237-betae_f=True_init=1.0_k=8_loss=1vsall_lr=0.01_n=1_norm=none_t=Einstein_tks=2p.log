2022-07-31 05:52:04,690 INFO     ---------------------------------------------------------------------------------------------
2022-07-31 05:52:04,693 INFO     Geo: cqd
2022-07-31 05:52:04,693 INFO     Data Path: data/FB15k-237-betae
2022-07-31 05:52:04,693 INFO     #entity: 14505
2022-07-31 05:52:04,693 INFO     #relation: 474
2022-07-31 05:52:04,693 INFO     #max steps: 150000
2022-07-31 05:52:04,693 INFO     Evaluate unoins using: DNF
2022-07-31 05:52:04,693 INFO     loading data
2022-07-31 05:52:46,031 INFO     Training info:
2022-07-31 05:52:46,035 INFO     2p: 149689
2022-07-31 05:52:48,111 INFO     Validation info:
2022-07-31 05:52:48,111 INFO     2p: 5000
2022-07-31 05:52:48,113 INFO     Test info:
2022-07-31 05:52:48,113 INFO     2p: 5000
2022-07-31 05:52:51,707 INFO     Model Parameter Configuration:
2022-07-31 05:52:51,708 INFO     Parameter embeddings.0.weight: torch.Size([14505, 2000]), require_grad = False
2022-07-31 05:52:51,708 INFO     Parameter embeddings.1.weight: torch.Size([474, 2000]), require_grad = False
2022-07-31 05:52:51,708 INFO     Parameter score_transform_fun.weight: torch.Size([2, 2000]), require_grad = True
2022-07-31 05:52:51,708 INFO     Parameter score_transform_fun.bias: torch.Size([2]), require_grad = True
2022-07-31 05:52:51,708 INFO     Parameter score_transform_ent_fun.weight: torch.Size([2, 2000]), require_grad = True
2022-07-31 05:52:51,708 INFO     Parameter score_transform_ent_fun.bias: torch.Size([2]), require_grad = True
2022-07-31 05:52:51,708 INFO     Parameter Number: 8004
2022-07-31 05:52:51,732 INFO     Loading checkpoint models/fb15k-237-betae...
2022-07-31 05:52:52,219 INFO     tasks = 2p
2022-07-31 05:52:52,219 INFO     init_step = 99999
2022-07-31 05:52:52,219 INFO     Start Training...
2022-07-31 05:52:52,219 INFO     learning_rate = 0
2022-07-31 05:52:52,219 INFO     batch_size = 1024
2022-07-31 05:52:52,219 INFO     hidden_dim = 1000
2022-07-31 05:52:52,219 INFO     gamma = 12.000000
2022-07-31 05:52:56,510 INFO     Evaluating on Valid Dataset...
posix.uname_result(sysname='Linux', nodename='sweetums-609-1.local', release='3.10.0-1160.49.1.el7.x86_64', version='#1 SMP Tue Nov 30 15:51:32 UTC 2021', machine='x86_64')
  0%|          | 0/5000 [00:00<?, ?it/s]2022-07-31 05:52:56,705 INFO     Evaluating the model... (0/5000)
  1%|          | 31/5000 [00:00<00:16, 302.73it/s]  1%|▏         | 69/5000 [00:00<00:14, 345.90it/s]  2%|▏         | 104/5000 [00:00<00:14, 345.46it/s]  3%|▎         | 142/5000 [00:00<00:13, 357.14it/s]  4%|▎         | 178/5000 [00:00<00:13, 355.79it/s]  4%|▍         | 215/5000 [00:00<00:13, 359.18it/s]  5%|▌         | 252/5000 [00:00<00:13, 360.83it/s]  6%|▌         | 289/5000 [00:00<00:13, 358.77it/s]  7%|▋         | 328/5000 [00:00<00:12, 365.35it/s]  7%|▋         | 365/5000 [00:01<00:12, 360.12it/s]  8%|▊         | 404/5000 [00:01<00:12, 366.93it/s]  9%|▉         | 441/5000 [00:01<00:12, 359.28it/s] 10%|▉         | 479/5000 [00:01<00:12, 363.80it/s] 10%|█         | 516/5000 [00:01<00:12, 357.45it/s] 11%|█         | 554/5000 [00:01<00:12, 362.58it/s] 12%|█▏        | 591/5000 [00:01<00:12, 356.65it/s] 13%|█▎        | 628/5000 [00:01<00:12, 359.49it/s] 13%|█▎        | 664/5000 [00:01<00:12, 355.66it/s] 14%|█▍        | 700/5000 [00:01<00:12, 355.30it/s] 15%|█▍        | 737/5000 [00:02<00:11, 356.74it/s] 15%|█▌        | 773/5000 [00:02<00:12, 351.32it/s] 16%|█▌        | 810/5000 [00:02<00:11, 354.51it/s] 17%|█▋        | 846/5000 [00:02<00:11, 346.81it/s] 18%|█▊        | 882/5000 [00:02<00:11, 349.74it/s] 18%|█▊        | 918/5000 [00:02<00:11, 343.47it/s] 19%|█▉        | 955/5000 [00:02<00:11, 350.06it/s] 20%|█▉        | 991/5000 [00:02<00:11, 345.96it/s] 21%|██        | 1027/5000 [00:02<00:11, 349.82it/s] 21%|██▏       | 1063/5000 [00:03<00:11, 344.76it/s] 22%|██▏       | 1099/5000 [00:03<00:11, 347.85it/s] 23%|██▎       | 1134/5000 [00:03<00:11, 344.04it/s] 23%|██▎       | 1169/5000 [00:03<00:11, 345.52it/s] 24%|██▍       | 1205/5000 [00:03<00:10, 346.91it/s] 25%|██▍       | 1240/5000 [00:03<00:11, 333.30it/s] 26%|██▌       | 1277/5000 [00:03<00:10, 342.37it/s] 26%|██▌       | 1312/5000 [00:03<00:10, 341.35it/s] 27%|██▋       | 1347/5000 [00:03<00:11, 328.48it/s] 28%|██▊       | 1381/5000 [00:03<00:11, 327.08it/s] 28%|██▊       | 1414/5000 [00:04<00:10, 326.28it/s] 29%|██▉       | 1447/5000 [00:04<00:12, 285.15it/s] 30%|██▉       | 1479/5000 [00:04<00:12, 292.89it/s] 30%|███       | 1510/5000 [00:04<00:11, 292.49it/s] 31%|███       | 1547/5000 [00:04<00:11, 312.52it/s] 32%|███▏      | 1582/5000 [00:04<00:10, 322.73it/s] 32%|███▏      | 1619/5000 [00:04<00:10, 334.69it/s] 33%|███▎      | 1654/5000 [00:04<00:09, 337.88it/s] 34%|███▍      | 1691/5000 [00:04<00:09, 344.95it/s] 35%|███▍      | 1726/5000 [00:05<00:09, 345.57it/s] 35%|███▌      | 1763/5000 [00:05<00:09, 351.63it/s] 36%|███▌      | 1799/5000 [00:05<00:09, 349.80it/s] 37%|███▋      | 1837/5000 [00:05<00:08, 356.59it/s] 37%|███▋      | 1873/5000 [00:05<00:08, 357.10it/s] 38%|███▊      | 1910/5000 [00:05<00:08, 360.12it/s] 39%|███▉      | 1947/5000 [00:05<00:08, 362.32it/s] 40%|███▉      | 1984/5000 [00:05<00:08, 361.18it/s] 40%|████      | 2021/5000 [00:05<00:08, 362.60it/s] 41%|████      | 2058/5000 [00:05<00:08, 361.55it/s] 42%|████▏     | 2096/5000 [00:06<00:07, 364.94it/s] 43%|████▎     | 2133/5000 [00:06<00:07, 360.86it/s] 43%|████▎     | 2170/5000 [00:06<00:07, 362.72it/s] 44%|████▍     | 2207/5000 [00:06<00:07, 358.20it/s] 45%|████▍     | 2243/5000 [00:06<00:07, 357.25it/s] 46%|████▌     | 2279/5000 [00:06<00:07, 354.30it/s] 46%|████▋     | 2316/5000 [00:06<00:07, 357.62it/s] 47%|████▋     | 2352/5000 [00:06<00:07, 356.26it/s] 48%|████▊     | 2389/5000 [00:06<00:07, 359.73it/s] 48%|████▊     | 2425/5000 [00:06<00:07, 359.04it/s] 49%|████▉     | 2461/5000 [00:07<00:07, 359.23it/s] 50%|████▉     | 2497/5000 [00:07<00:07, 352.01it/s] 51%|█████     | 2533/5000 [00:07<00:07, 347.99it/s] 51%|█████▏    | 2571/5000 [00:07<00:06, 354.48it/s] 52%|█████▏    | 2607/5000 [00:07<00:06, 350.15it/s] 53%|█████▎    | 2645/5000 [00:07<00:06, 358.57it/s] 54%|█████▎    | 2681/5000 [00:07<00:06, 351.82it/s] 54%|█████▍    | 2718/5000 [00:07<00:06, 356.84it/s] 55%|█████▌    | 2754/5000 [00:07<00:06, 348.78it/s] 56%|█████▌    | 2791/5000 [00:08<00:06, 353.98it/s] 57%|█████▋    | 2827/5000 [00:08<00:06, 348.48it/s] 57%|█████▋    | 2863/5000 [00:08<00:06, 349.66it/s] 58%|█████▊    | 2899/5000 [00:08<00:06, 344.36it/s] 59%|█████▊    | 2935/5000 [00:08<00:05, 346.90it/s] 59%|█████▉    | 2971/5000 [00:08<00:05, 348.83it/s] 60%|██████    | 3006/5000 [00:08<00:05, 345.19it/s] 61%|██████    | 3043/5000 [00:08<00:05, 350.94it/s] 62%|██████▏   | 3079/5000 [00:08<00:05, 345.77it/s] 62%|██████▏   | 3114/5000 [00:08<00:05, 339.66it/s] 63%|██████▎   | 3149/5000 [00:09<00:05, 338.26it/s] 64%|██████▎   | 3186/5000 [00:09<00:05, 345.37it/s] 64%|██████▍   | 3221/5000 [00:09<00:05, 344.53it/s] 65%|██████▌   | 3257/5000 [00:09<00:05, 347.99it/s] 66%|██████▌   | 3292/5000 [00:09<00:04, 347.96it/s] 67%|██████▋   | 3330/5000 [00:09<00:04, 356.15it/s] 67%|██████▋   | 3366/5000 [00:09<00:04, 354.23it/s] 68%|██████▊   | 3404/5000 [00:09<00:04, 359.03it/s] 69%|██████▉   | 3440/5000 [00:09<00:04, 358.99it/s] 70%|██████▉   | 3477/5000 [00:09<00:04, 359.56it/s] 70%|███████   | 3514/5000 [00:10<00:04, 360.88it/s] 71%|███████   | 3551/5000 [00:10<00:04, 357.84it/s] 72%|███████▏  | 3588/5000 [00:10<00:03, 360.71it/s] 72%|███████▎  | 3625/5000 [00:10<00:03, 356.45it/s] 73%|███████▎  | 3662/5000 [00:10<00:03, 359.29it/s] 74%|███████▍  | 3698/5000 [00:10<00:03, 354.92it/s] 75%|███████▍  | 3735/5000 [00:10<00:03, 357.96it/s] 75%|███████▌  | 3771/5000 [00:10<00:03, 353.59it/s] 76%|███████▌  | 3807/5000 [00:10<00:03, 352.65it/s] 77%|███████▋  | 3843/5000 [00:10<00:03, 349.30it/s] 78%|███████▊  | 3880/5000 [00:11<00:03, 353.45it/s] 78%|███████▊  | 3916/5000 [00:11<00:03, 350.71it/s] 79%|███████▉  | 3953/5000 [00:11<00:02, 353.94it/s] 80%|███████▉  | 3989/5000 [00:11<00:02, 354.71it/s] 81%|████████  | 4026/5000 [00:11<00:02, 357.75it/s] 81%|████████▏ | 4063/5000 [00:11<00:02, 359.26it/s] 82%|████████▏ | 4099/5000 [00:11<00:02, 359.14it/s] 83%|████████▎ | 4137/5000 [00:11<00:02, 362.43it/s] 83%|████████▎ | 4174/5000 [00:11<00:02, 359.62it/s] 84%|████████▍ | 4212/5000 [00:12<00:02, 362.87it/s] 85%|████████▍ | 4249/5000 [00:12<00:02, 358.58it/s] 86%|████████▌ | 4286/5000 [00:12<00:01, 361.14it/s] 86%|████████▋ | 4323/5000 [00:12<00:01, 357.04it/s] 87%|████████▋ | 4360/5000 [00:12<00:01, 358.70it/s] 88%|████████▊ | 4396/5000 [00:12<00:01, 354.88it/s] 89%|████████▊ | 4433/5000 [00:12<00:01, 358.87it/s] 89%|████████▉ | 4469/5000 [00:12<00:01, 354.38it/s] 90%|█████████ | 4507/5000 [00:12<00:01, 359.10it/s] 91%|█████████ | 4543/5000 [00:12<00:01, 354.61it/s] 92%|█████████▏| 4581/5000 [00:13<00:01, 359.19it/s] 92%|█████████▏| 4617/5000 [00:13<00:01, 354.81it/s] 93%|█████████▎| 4653/5000 [00:13<00:00, 354.89it/s] 94%|█████████▍| 4689/5000 [00:13<00:00, 356.11it/s] 95%|█████████▍| 4726/5000 [00:13<00:00, 360.02it/s] 95%|█████████▌| 4764/5000 [00:13<00:00, 363.09it/s] 96%|█████████▌| 4801/5000 [00:13<00:00, 360.35it/s] 97%|█████████▋| 4839/5000 [00:13<00:00, 364.73it/s] 98%|█████████▊| 4876/5000 [00:13<00:00, 361.35it/s] 98%|█████████▊| 4913/5000 [00:13<00:00, 363.07it/s] 99%|█████████▉| 4950/5000 [00:14<00:00, 359.15it/s]100%|█████████▉| 4988/5000 [00:14<00:00, 363.96it/s]100%|██████████| 5000/5000 [00:14<00:00, 351.69it/s]
2022-07-31 05:53:10,914 INFO     Valid 2p MRR at step 100000: 0.001484
2022-07-31 05:53:10,914 INFO     Valid 2p HITS1 at step 100000: 0.000053
2022-07-31 05:53:10,915 INFO     Valid 2p HITS3 at step 100000: 0.000249
2022-07-31 05:53:10,915 INFO     Valid 2p HITS10 at step 100000: 0.001098
2022-07-31 05:53:10,915 INFO     Valid 2p num_queries at step 100000: 5000.000000
2022-07-31 05:53:10,915 INFO     Valid average MRR at step 100000: 0.001484
2022-07-31 05:53:10,915 INFO     Valid average HITS1 at step 100000: 0.000053
2022-07-31 05:53:10,915 INFO     Valid average HITS3 at step 100000: 0.000249
2022-07-31 05:53:10,915 INFO     Valid average HITS10 at step 100000: 0.001098
2022-07-31 05:53:10,915 INFO     Evaluating on Test Dataset...
  0%|          | 0/5000 [00:00<?, ?it/s]2022-07-31 05:53:10,918 INFO     Evaluating the model... (0/5000)
  1%|          | 37/5000 [00:00<00:13, 366.14it/s]  2%|▏         | 76/5000 [00:00<00:12, 379.95it/s]  2%|▏         | 115/5000 [00:00<00:13, 374.53it/s]  3%|▎         | 154/5000 [00:00<00:12, 379.64it/s]  4%|▍         | 192/5000 [00:00<00:12, 377.16it/s]  5%|▍         | 231/5000 [00:00<00:12, 380.35it/s]  5%|▌         | 270/5000 [00:00<00:12, 380.11it/s]  6%|▌         | 309/5000 [00:00<00:12, 382.65it/s]  7%|▋         | 348/5000 [00:00<00:12, 384.62it/s]  8%|▊         | 387/5000 [00:01<00:12, 381.40it/s]  9%|▊         | 427/5000 [00:01<00:11, 386.21it/s]  9%|▉         | 466/5000 [00:01<00:11, 382.36it/s] 10%|█         | 505/5000 [00:01<00:11, 383.15it/s] 11%|█         | 544/5000 [00:01<00:11, 379.75it/s] 12%|█▏        | 584/5000 [00:01<00:11, 385.10it/s] 12%|█▏        | 623/5000 [00:01<00:11, 381.28it/s] 13%|█▎        | 664/5000 [00:01<00:11, 387.27it/s] 14%|█▍        | 703/5000 [00:01<00:11, 382.72it/s] 15%|█▍        | 743/5000 [00:01<00:10, 387.27it/s] 16%|█▌        | 782/5000 [00:02<00:11, 382.18it/s] 16%|█▋        | 822/5000 [00:02<00:10, 387.30it/s] 17%|█▋        | 861/5000 [00:02<00:10, 385.03it/s] 18%|█▊        | 901/5000 [00:02<00:10, 386.79it/s] 19%|█▉        | 940/5000 [00:02<00:10, 385.33it/s] 20%|█▉        | 979/5000 [00:02<00:10, 384.61it/s] 20%|██        | 1018/5000 [00:02<00:10, 386.05it/s] 21%|██        | 1057/5000 [00:02<00:10, 383.09it/s] 22%|██▏       | 1097/5000 [00:02<00:10, 386.22it/s] 23%|██▎       | 1136/5000 [00:02<00:10, 377.32it/s] 24%|██▎       | 1175/5000 [00:03<00:10, 380.08it/s] 24%|██▍       | 1214/5000 [00:03<00:10, 377.13it/s] 25%|██▌       | 1254/5000 [00:03<00:09, 381.85it/s] 26%|██▌       | 1293/5000 [00:03<00:09, 378.40it/s] 27%|██▋       | 1333/5000 [00:03<00:09, 381.99it/s] 27%|██▋       | 1372/5000 [00:03<00:09, 377.41it/s] 28%|██▊       | 1411/5000 [00:03<00:09, 380.57it/s] 29%|██▉       | 1450/5000 [00:03<00:09, 376.63it/s] 30%|██▉       | 1489/5000 [00:03<00:09, 379.04it/s] 31%|███       | 1527/5000 [00:04<00:09, 375.32it/s] 31%|███▏      | 1565/5000 [00:04<00:09, 375.00it/s] 32%|███▏      | 1603/5000 [00:04<00:09, 374.42it/s] 33%|███▎      | 1641/5000 [00:04<00:08, 374.09it/s] 34%|███▎      | 1679/5000 [00:04<00:08, 374.12it/s] 34%|███▍      | 1717/5000 [00:04<00:08, 366.95it/s] 35%|███▌      | 1755/5000 [00:04<00:08, 370.22it/s] 36%|███▌      | 1793/5000 [00:04<00:08, 366.43it/s] 37%|███▋      | 1831/5000 [00:04<00:08, 369.58it/s] 37%|███▋      | 1868/5000 [00:04<00:08, 364.44it/s] 38%|███▊      | 1906/5000 [00:05<00:08, 368.46it/s] 39%|███▉      | 1943/5000 [00:05<00:08, 363.90it/s] 40%|███▉      | 1981/5000 [00:05<00:08, 367.50it/s] 40%|████      | 2018/5000 [00:05<00:08, 361.90it/s] 41%|████      | 2056/5000 [00:05<00:08, 364.79it/s] 42%|████▏     | 2093/5000 [00:05<00:08, 361.02it/s] 43%|████▎     | 2130/5000 [00:05<00:07, 363.58it/s] 43%|████▎     | 2167/5000 [00:05<00:07, 359.91it/s] 44%|████▍     | 2205/5000 [00:05<00:07, 363.05it/s] 45%|████▍     | 2242/5000 [00:05<00:07, 361.67it/s] 46%|████▌     | 2279/5000 [00:06<00:07, 358.03it/s] 46%|████▋     | 2316/5000 [00:06<00:07, 358.78it/s] 47%|████▋     | 2352/5000 [00:06<00:07, 357.72it/s] 48%|████▊     | 2389/5000 [00:06<00:07, 359.69it/s] 48%|████▊     | 2425/5000 [00:06<00:07, 355.85it/s] 49%|████▉     | 2462/5000 [00:06<00:07, 359.23it/s] 50%|████▉     | 2498/5000 [00:06<00:07, 354.89it/s] 51%|█████     | 2535/5000 [00:06<00:06, 358.57it/s] 51%|█████▏    | 2571/5000 [00:06<00:06, 356.20it/s] 52%|█████▏    | 2610/5000 [00:06<00:06, 363.54it/s] 53%|█████▎    | 2647/5000 [00:07<00:06, 360.48it/s] 54%|█████▎    | 2685/5000 [00:07<00:06, 365.75it/s] 54%|█████▍    | 2722/5000 [00:07<00:06, 363.00it/s] 55%|█████▌    | 2759/5000 [00:07<00:06, 365.02it/s] 56%|█████▌    | 2796/5000 [00:07<00:06, 362.93it/s] 57%|█████▋    | 2833/5000 [00:07<00:05, 362.73it/s] 57%|█████▋    | 2870/5000 [00:07<00:05, 359.02it/s] 58%|█████▊    | 2906/5000 [00:07<00:05, 359.00it/s] 59%|█████▉    | 2943/5000 [00:07<00:05, 360.83it/s] 60%|█████▉    | 2980/5000 [00:08<00:05, 357.65it/s] 60%|██████    | 3017/5000 [00:08<00:05, 361.21it/s] 61%|██████    | 3054/5000 [00:08<00:05, 356.70it/s] 62%|██████▏   | 3091/5000 [00:08<00:05, 360.03it/s] 63%|██████▎   | 3128/5000 [00:09<00:16, 114.96it/s] 63%|██████▎   | 3163/5000 [00:09<00:12, 142.33it/s] 64%|██████▍   | 3198/5000 [00:09<00:10, 171.87it/s] 65%|██████▍   | 3234/5000 [00:09<00:08, 203.58it/s] 65%|██████▌   | 3270/5000 [00:09<00:07, 233.05it/s] 66%|██████▌   | 3308/5000 [00:09<00:06, 263.84it/s] 67%|██████▋   | 3343/5000 [00:09<00:05, 284.05it/s] 68%|██████▊   | 3381/5000 [00:09<00:05, 307.45it/s] 68%|██████▊   | 3417/5000 [00:09<00:04, 316.87it/s] 69%|██████▉   | 3455/5000 [00:10<00:04, 333.06it/s] 70%|██████▉   | 3491/5000 [00:10<00:04, 338.00it/s] 71%|███████   | 3528/5000 [00:10<00:04, 346.49it/s] 71%|███████▏  | 3564/5000 [00:10<00:04, 348.78it/s] 72%|███████▏  | 3600/5000 [00:10<00:03, 351.48it/s] 73%|███████▎  | 3636/5000 [00:10<00:03, 353.53it/s] 73%|███████▎  | 3672/5000 [00:10<00:03, 353.32it/s] 74%|███████▍  | 3709/5000 [00:10<00:03, 355.92it/s] 75%|███████▍  | 3745/5000 [00:10<00:03, 352.16it/s] 76%|███████▌  | 3782/5000 [00:10<00:03, 355.52it/s] 76%|███████▋  | 3818/5000 [00:11<00:03, 351.11it/s] 77%|███████▋  | 3855/5000 [00:11<00:03, 354.25it/s] 78%|███████▊  | 3891/5000 [00:11<00:03, 350.35it/s] 79%|███████▊  | 3928/5000 [00:11<00:03, 353.24it/s] 79%|███████▉  | 3964/5000 [00:11<00:02, 353.45it/s] 80%|████████  | 4001/5000 [00:11<00:02, 357.18it/s] 81%|████████  | 4037/5000 [00:11<00:02, 357.29it/s] 81%|████████▏ | 4074/5000 [00:11<00:02, 359.18it/s] 82%|████████▏ | 4111/5000 [00:11<00:02, 360.55it/s] 83%|████████▎ | 4148/5000 [00:12<00:02, 360.33it/s] 84%|████████▎ | 4186/5000 [00:12<00:02, 364.01it/s] 84%|████████▍ | 4223/5000 [00:12<00:02, 359.60it/s] 85%|████████▌ | 4261/5000 [00:12<00:02, 364.02it/s] 86%|████████▌ | 4298/5000 [00:12<00:01, 358.56it/s] 87%|████████▋ | 4336/5000 [00:12<00:01, 362.98it/s] 87%|████████▋ | 4373/5000 [00:12<00:01, 358.94it/s] 88%|████████▊ | 4410/5000 [00:12<00:01, 359.49it/s] 89%|████████▉ | 4446/5000 [00:12<00:01, 332.35it/s] 90%|████████▉ | 4483/5000 [00:12<00:01, 341.21it/s] 90%|█████████ | 4519/5000 [00:13<00:01, 343.81it/s] 91%|█████████ | 4555/5000 [00:13<00:01, 348.15it/s] 92%|█████████▏| 4591/5000 [00:13<00:01, 349.96it/s] 93%|█████████▎| 4627/5000 [00:13<00:01, 350.51it/s] 93%|█████████▎| 4664/5000 [00:13<00:00, 354.46it/s] 94%|█████████▍| 4700/5000 [00:13<00:00, 355.08it/s] 95%|█████████▍| 4738/5000 [00:13<00:00, 360.84it/s] 96%|█████████▌| 4775/5000 [00:13<00:00, 358.72it/s] 96%|█████████▋| 4813/5000 [00:13<00:00, 362.67it/s] 97%|█████████▋| 4850/5000 [00:13<00:00, 358.63it/s] 98%|█████████▊| 4888/5000 [00:14<00:00, 362.70it/s] 98%|█████████▊| 4925/5000 [00:14<00:00, 358.10it/s] 99%|█████████▉| 4962/5000 [00:14<00:00, 360.97it/s]100%|█████████▉| 4999/5000 [00:14<00:00, 357.00it/s]100%|██████████| 5000/5000 [00:14<00:00, 346.96it/s]
2022-07-31 05:53:25,328 INFO     Test 2p MRR at step 100000: 0.001574
2022-07-31 05:53:25,328 INFO     Test 2p HITS1 at step 100000: 0.000045
2022-07-31 05:53:25,328 INFO     Test 2p HITS3 at step 100000: 0.000275
2022-07-31 05:53:25,328 INFO     Test 2p HITS10 at step 100000: 0.001145
2022-07-31 05:53:25,328 INFO     Test 2p num_queries at step 100000: 5000.000000
2022-07-31 05:53:25,328 INFO     Test average MRR at step 100000: 0.001574
2022-07-31 05:53:25,328 INFO     Test average HITS1 at step 100000: 0.000045
2022-07-31 05:53:25,328 INFO     Test average HITS3 at step 100000: 0.000275
2022-07-31 05:53:25,328 INFO     Test average HITS10 at step 100000: 0.001145
2022-07-31 05:53:25,328 INFO     Training average positive_sample_loss at step 100000: 124534.667969
2022-07-31 05:53:25,329 INFO     Training average negative_sample_loss at step 100000: 124534.667969
2022-07-31 05:53:25,329 INFO     Training average loss at step 100000: 124534.667969
/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in LogSoftmaxBackward0. Traceback of forward call that caused the error:
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 537, in main
    log = KGReasoning.train_step(model, optimizer, train_path_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 712, in train_step
    loss_query_type = ce_loss(all_logit, positive_sample)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 1163, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/functional.py", line 2996, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
 (Triggered internally at  ../torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Traceback (most recent call last):
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 537, in main
    log = KGReasoning.train_step(model, optimizer, train_path_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 931, in train_step
    loss.backward()
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'LogSoftmaxBackward0' returned nan values in its 0th output.
