2022-08-01 18:41:03,897 INFO     ---------------------------------------------------------------------------------------------
2022-08-01 18:41:03,897 INFO     Geo: cqd
2022-08-01 18:41:03,897 INFO     Data Path: data/FB15k-237-betae
2022-08-01 18:41:03,897 INFO     #entity: 14505
2022-08-01 18:41:03,897 INFO     #relation: 474
2022-08-01 18:41:03,897 INFO     #max steps: 150000
2022-08-01 18:41:03,897 INFO     Evaluate unoins using: DNF
2022-08-01 18:41:03,897 INFO     loading data
2022-08-01 18:41:51,833 INFO     Training info:
2022-08-01 18:41:51,836 INFO     2i: 149689
2022-08-01 18:41:52,493 INFO     Validation info:
2022-08-01 18:41:52,493 INFO     2i: 5000
2022-08-01 18:41:52,495 INFO     Test info:
2022-08-01 18:41:52,495 INFO     2i: 5000
2022-08-01 18:41:57,267 INFO     Model Parameter Configuration:
2022-08-01 18:41:57,268 INFO     Parameter embeddings.0.weight: torch.Size([14505, 2000]), require_grad = False
2022-08-01 18:41:57,268 INFO     Parameter embeddings.1.weight: torch.Size([474, 2000]), require_grad = False
2022-08-01 18:41:57,268 INFO     Parameter score_transform_fun.weight: torch.Size([2, 2000]), require_grad = True
2022-08-01 18:41:57,268 INFO     Parameter score_transform_fun.bias: torch.Size([2]), require_grad = True
2022-08-01 18:41:57,268 INFO     Parameter score_transform_ent_fun.weight: torch.Size([2, 2000]), require_grad = True
2022-08-01 18:41:57,268 INFO     Parameter score_transform_ent_fun.bias: torch.Size([2]), require_grad = True
2022-08-01 18:41:57,268 INFO     Parameter Number: 8004
2022-08-01 18:41:57,330 INFO     Loading checkpoint models/fb15k-237-betae...
2022-08-01 18:41:57,602 INFO     tasks = 2i
2022-08-01 18:41:57,602 INFO     init_step = 99999
2022-08-01 18:41:57,602 INFO     Start Training...
2022-08-01 18:41:57,602 INFO     learning_rate = 0
2022-08-01 18:41:57,602 INFO     batch_size = 1024
2022-08-01 18:41:57,603 INFO     hidden_dim = 1000
2022-08-01 18:41:57,603 INFO     gamma = 12.000000
2022-08-01 18:41:58,282 INFO     Evaluating on Valid Dataset...
posix.uname_result(sysname='Linux', nodename='sweetums-609-7.local', release='3.10.0-1160.66.1.el7.x86_64', version='#1 SMP Wed May 18 16:02:34 UTC 2022', machine='x86_64')
  0%|          | 0/5000 [00:00<?, ?it/s]2022-08-01 18:41:58,307 INFO     Evaluating the model... (0/5000)
  1%|          | 37/5000 [00:00<00:13, 363.99it/s]  2%|▏         | 75/5000 [00:00<00:13, 372.51it/s]  2%|▏         | 114/5000 [00:00<00:12, 379.21it/s]  3%|▎         | 152/5000 [00:00<00:12, 375.17it/s]  4%|▍         | 191/5000 [00:00<00:12, 379.75it/s]  5%|▍         | 229/5000 [00:00<00:12, 376.56it/s]  5%|▌         | 267/5000 [00:00<00:12, 374.76it/s]  6%|▌         | 305/5000 [00:00<00:12, 373.98it/s]  7%|▋         | 343/5000 [00:00<00:12, 373.18it/s]  8%|▊         | 381/5000 [00:01<00:12, 369.21it/s]  8%|▊         | 419/5000 [00:01<00:12, 370.93it/s]  9%|▉         | 459/5000 [00:01<00:12, 377.88it/s] 10%|▉         | 499/5000 [00:01<00:11, 383.98it/s] 11%|█         | 539/5000 [00:01<00:11, 386.35it/s] 12%|█▏        | 578/5000 [00:01<00:11, 369.86it/s] 12%|█▏        | 618/5000 [00:01<00:11, 376.31it/s] 13%|█▎        | 658/5000 [00:01<00:11, 380.67it/s] 14%|█▍        | 697/5000 [00:01<00:13, 316.35it/s] 15%|█▍        | 731/5000 [00:02<00:16, 264.98it/s] 15%|█▌        | 768/5000 [00:02<00:14, 288.96it/s] 16%|█▌        | 800/5000 [00:02<00:16, 254.70it/s] 17%|█▋        | 841/5000 [00:02<00:14, 289.69it/s] 18%|█▊        | 881/5000 [00:02<00:13, 316.08it/s] 18%|█▊        | 922/5000 [00:02<00:12, 339.62it/s] 19%|█▉        | 958/5000 [00:02<00:11, 343.70it/s] 20%|█▉        | 997/5000 [00:02<00:11, 356.43it/s] 21%|██        | 1036/5000 [00:02<00:10, 364.04it/s] 21%|██▏       | 1074/5000 [00:03<00:11, 334.65it/s] 22%|██▏       | 1109/5000 [00:03<00:14, 267.45it/s] 23%|██▎       | 1139/5000 [00:03<00:15, 247.00it/s] 24%|██▎       | 1176/5000 [00:03<00:13, 274.61it/s] 24%|██▍       | 1207/5000 [00:03<00:13, 282.69it/s] 25%|██▍       | 1245/5000 [00:03<00:12, 307.75it/s] 26%|██▌       | 1284/5000 [00:03<00:11, 329.83it/s] 26%|██▋       | 1322/5000 [00:03<00:10, 343.20it/s] 27%|██▋       | 1362/5000 [00:04<00:10, 358.98it/s] 28%|██▊       | 1400/5000 [00:04<00:09, 362.72it/s] 29%|██▉       | 1441/5000 [00:04<00:09, 374.37it/s] 30%|██▉       | 1479/5000 [00:04<00:09, 371.50it/s] 30%|███       | 1517/5000 [00:04<00:09, 367.46it/s] 31%|███       | 1555/5000 [00:04<00:09, 368.50it/s] 32%|███▏      | 1592/5000 [00:04<00:09, 365.39it/s] 33%|███▎      | 1629/5000 [00:04<00:09, 364.30it/s] 33%|███▎      | 1666/5000 [00:04<00:09, 363.64it/s] 34%|███▍      | 1706/5000 [00:04<00:08, 374.23it/s] 35%|███▍      | 1744/5000 [00:05<00:08, 361.84it/s] 36%|███▌      | 1783/5000 [00:05<00:08, 369.97it/s] 36%|███▋      | 1821/5000 [00:05<00:08, 372.79it/s] 37%|███▋      | 1859/5000 [00:05<00:08, 359.87it/s] 38%|███▊      | 1899/5000 [00:05<00:08, 369.87it/s] 39%|███▊      | 1937/5000 [00:05<00:08, 371.55it/s] 40%|███▉      | 1975/5000 [00:05<00:08, 372.80it/s] 40%|████      | 2014/5000 [00:05<00:07, 375.95it/s] 41%|████      | 2052/5000 [00:05<00:07, 375.95it/s] 42%|████▏     | 2090/5000 [00:06<00:07, 374.38it/s] 43%|████▎     | 2128/5000 [00:06<00:09, 304.25it/s] 43%|████▎     | 2162/5000 [00:06<00:09, 313.28it/s] 44%|████▍     | 2195/5000 [00:06<00:08, 316.77it/s] 45%|████▍     | 2228/5000 [00:06<00:08, 310.92it/s] 45%|████▌     | 2266/5000 [00:06<00:08, 328.50it/s] 46%|████▌     | 2304/5000 [00:06<00:07, 341.61it/s] 47%|████▋     | 2342/5000 [00:06<00:07, 338.81it/s] 48%|████▊     | 2377/5000 [00:06<00:08, 315.06it/s] 48%|████▊     | 2416/5000 [00:07<00:07, 333.29it/s] 49%|████▉     | 2454/5000 [00:07<00:07, 345.22it/s] 50%|████▉     | 2494/5000 [00:07<00:06, 359.02it/s] 51%|█████     | 2533/5000 [00:07<00:06, 366.92it/s] 51%|█████▏    | 2573/5000 [00:07<00:06, 376.25it/s] 52%|█████▏    | 2611/5000 [00:07<00:06, 374.83it/s] 53%|█████▎    | 2649/5000 [00:07<00:07, 304.59it/s] 54%|█████▎    | 2687/5000 [00:07<00:07, 321.79it/s] 54%|█████▍    | 2723/5000 [00:07<00:06, 330.45it/s] 55%|█████▌    | 2761/5000 [00:08<00:06, 342.01it/s] 56%|█████▌    | 2799/5000 [00:08<00:06, 350.23it/s] 57%|█████▋    | 2835/5000 [00:08<00:06, 344.41it/s] 57%|█████▋    | 2872/5000 [00:08<00:06, 351.60it/s] 58%|█████▊    | 2911/5000 [00:08<00:05, 361.82it/s] 59%|█████▉    | 2951/5000 [00:08<00:05, 370.53it/s] 60%|█████▉    | 2990/5000 [00:08<00:05, 374.15it/s] 61%|██████    | 3030/5000 [00:08<00:05, 380.64it/s] 61%|██████▏   | 3069/5000 [00:08<00:05, 376.08it/s] 62%|██████▏   | 3107/5000 [00:08<00:05, 373.01it/s] 63%|██████▎   | 3145/5000 [00:09<00:05, 370.90it/s] 64%|██████▎   | 3183/5000 [00:09<00:04, 366.14it/s] 64%|██████▍   | 3220/5000 [00:09<00:04, 366.91it/s] 65%|██████▌   | 3257/5000 [00:09<00:04, 358.92it/s] 66%|██████▌   | 3297/5000 [00:09<00:04, 369.54it/s] 67%|██████▋   | 3337/5000 [00:09<00:04, 376.76it/s] 68%|██████▊   | 3378/5000 [00:09<00:04, 384.09it/s] 68%|██████▊   | 3417/5000 [00:09<00:04, 382.71it/s] 69%|██████▉   | 3457/5000 [00:09<00:03, 387.41it/s] 70%|██████▉   | 3496/5000 [00:10<00:03, 387.27it/s] 71%|███████   | 3535/5000 [00:10<00:03, 387.05it/s] 71%|███████▏  | 3574/5000 [00:10<00:03, 378.89it/s] 72%|███████▏  | 3612/5000 [00:10<00:03, 376.35it/s] 73%|███████▎  | 3650/5000 [00:10<00:03, 370.95it/s] 74%|███████▍  | 3688/5000 [00:10<00:03, 370.99it/s] 75%|███████▍  | 3726/5000 [00:10<00:03, 371.02it/s] 75%|███████▌  | 3764/5000 [00:10<00:03, 372.99it/s] 76%|███████▌  | 3802/5000 [00:10<00:03, 362.58it/s] 77%|███████▋  | 3839/5000 [00:10<00:03, 363.54it/s] 78%|███████▊  | 3878/5000 [00:11<00:03, 370.42it/s] 78%|███████▊  | 3918/5000 [00:11<00:02, 378.23it/s] 79%|███████▉  | 3957/5000 [00:11<00:02, 381.64it/s] 80%|███████▉  | 3998/5000 [00:11<00:02, 388.88it/s] 81%|████████  | 4037/5000 [00:11<00:02, 382.58it/s] 82%|████████▏ | 4076/5000 [00:11<00:02, 378.04it/s] 82%|████████▏ | 4114/5000 [00:11<00:02, 363.30it/s] 83%|████████▎ | 4151/5000 [00:11<00:02, 362.37it/s] 84%|████████▍ | 4188/5000 [00:11<00:02, 364.08it/s] 85%|████████▍ | 4226/5000 [00:11<00:02, 367.81it/s] 85%|████████▌ | 4266/5000 [00:12<00:01, 374.63it/s] 86%|████████▌ | 4306/5000 [00:12<00:01, 379.82it/s] 87%|████████▋ | 4347/5000 [00:12<00:01, 387.44it/s] 88%|████████▊ | 4387/5000 [00:12<00:01, 388.90it/s] 89%|████████▊ | 4426/5000 [00:12<00:01, 379.68it/s] 89%|████████▉ | 4467/5000 [00:12<00:01, 385.63it/s] 90%|█████████ | 4506/5000 [00:12<00:01, 383.03it/s] 91%|█████████ | 4545/5000 [00:12<00:01, 377.36it/s] 92%|█████████▏| 4583/5000 [00:12<00:01, 374.71it/s] 92%|█████████▏| 4621/5000 [00:13<00:01, 374.12it/s] 93%|█████████▎| 4659/5000 [00:13<00:00, 369.63it/s] 94%|█████████▍| 4697/5000 [00:13<00:00, 372.04it/s] 95%|█████████▍| 4735/5000 [00:13<00:00, 370.07it/s] 95%|█████████▌| 4773/5000 [00:13<00:00, 372.91it/s] 96%|█████████▌| 4811/5000 [00:13<00:00, 370.39it/s] 97%|█████████▋| 4849/5000 [00:13<00:00, 361.73it/s] 98%|█████████▊| 4886/5000 [00:13<00:00, 361.66it/s] 98%|█████████▊| 4923/5000 [00:13<00:00, 360.99it/s] 99%|█████████▉| 4960/5000 [00:13<00:00, 361.48it/s]100%|█████████▉| 4997/5000 [00:14<00:00, 363.64it/s]100%|██████████| 5000/5000 [00:14<00:00, 355.59it/s]
2022-08-01 18:42:12,367 INFO     Valid 2i MRR at step 100000: 0.003451
2022-08-01 18:42:12,367 INFO     Valid 2i HITS1 at step 100000: 0.000400
2022-08-01 18:42:12,367 INFO     Valid 2i HITS3 at step 100000: 0.001000
2022-08-01 18:42:12,367 INFO     Valid 2i HITS10 at step 100000: 0.002400
2022-08-01 18:42:12,367 INFO     Valid 2i num_queries at step 100000: 5000.000000
2022-08-01 18:42:12,367 INFO     Valid average MRR at step 100000: 0.003451
2022-08-01 18:42:12,367 INFO     Valid average HITS1 at step 100000: 0.000400
2022-08-01 18:42:12,367 INFO     Valid average HITS3 at step 100000: 0.001000
2022-08-01 18:42:12,367 INFO     Valid average HITS10 at step 100000: 0.002400
2022-08-01 18:42:12,367 INFO     Evaluating on Test Dataset...
  0%|          | 0/5000 [00:00<?, ?it/s]2022-08-01 18:42:12,371 INFO     Evaluating the model... (0/5000)
  1%|          | 36/5000 [00:00<00:13, 356.37it/s]  1%|▏         | 73/5000 [00:00<00:13, 361.94it/s]  2%|▏         | 110/5000 [00:00<00:13, 365.09it/s]  3%|▎         | 150/5000 [00:00<00:12, 378.65it/s]  4%|▍         | 190/5000 [00:00<00:12, 384.21it/s]  5%|▍         | 229/5000 [00:00<00:12, 386.09it/s]  5%|▌         | 268/5000 [00:00<00:12, 381.43it/s]  6%|▌         | 307/5000 [00:00<00:12, 378.15it/s]  7%|▋         | 345/5000 [00:00<00:12, 372.27it/s]  8%|▊         | 383/5000 [00:01<00:12, 372.08it/s]  8%|▊         | 421/5000 [00:01<00:12, 371.98it/s]  9%|▉         | 459/5000 [00:01<00:12, 371.53it/s] 10%|▉         | 497/5000 [00:01<00:12, 360.99it/s] 11%|█         | 536/5000 [00:01<00:12, 368.90it/s] 12%|█▏        | 576/5000 [00:01<00:11, 375.27it/s] 12%|█▏        | 615/5000 [00:01<00:11, 378.91it/s] 13%|█▎        | 653/5000 [00:01<00:11, 377.13it/s] 14%|█▍        | 692/5000 [00:01<00:11, 380.82it/s] 15%|█▍        | 731/5000 [00:01<00:11, 378.80it/s] 15%|█▌        | 769/5000 [00:02<00:11, 362.11it/s] 16%|█▌        | 806/5000 [00:02<00:14, 295.83it/s] 17%|█▋        | 843/5000 [00:02<00:13, 314.18it/s] 18%|█▊        | 879/5000 [00:02<00:12, 325.87it/s] 18%|█▊        | 917/5000 [00:02<00:12, 338.55it/s] 19%|█▉        | 955/5000 [00:02<00:11, 350.09it/s] 20%|█▉        | 994/5000 [00:02<00:11, 359.67it/s] 21%|██        | 1032/5000 [00:02<00:10, 363.92it/s] 21%|██▏       | 1071/5000 [00:02<00:10, 369.46it/s] 22%|██▏       | 1110/5000 [00:03<00:10, 374.25it/s] 23%|██▎       | 1150/5000 [00:03<00:10, 379.19it/s] 24%|██▍       | 1189/5000 [00:03<00:10, 375.28it/s] 25%|██▍       | 1227/5000 [00:03<00:10, 370.57it/s] 25%|██▌       | 1265/5000 [00:03<00:10, 368.45it/s] 26%|██▌       | 1302/5000 [00:03<00:10, 353.12it/s] 27%|██▋       | 1339/5000 [00:03<00:10, 357.65it/s] 28%|██▊       | 1376/5000 [00:03<00:10, 359.51it/s] 28%|██▊       | 1413/5000 [00:03<00:09, 361.94it/s] 29%|██▉       | 1452/5000 [00:03<00:09, 369.77it/s] 30%|██▉       | 1491/5000 [00:04<00:09, 374.76it/s] 31%|███       | 1530/5000 [00:04<00:09, 379.08it/s] 31%|███▏      | 1570/5000 [00:04<00:08, 384.86it/s] 32%|███▏      | 1609/5000 [00:04<00:08, 385.04it/s] 33%|███▎      | 1649/5000 [00:04<00:08, 387.02it/s] 34%|███▍      | 1688/5000 [00:04<00:08, 378.01it/s] 35%|███▍      | 1726/5000 [00:04<00:10, 304.91it/s] 35%|███▌      | 1759/5000 [00:04<00:10, 308.49it/s] 36%|███▌      | 1796/5000 [00:04<00:09, 323.95it/s] 37%|███▋      | 1835/5000 [00:05<00:09, 340.59it/s] 37%|███▋      | 1874/5000 [00:05<00:08, 353.64it/s] 38%|███▊      | 1912/5000 [00:05<00:08, 360.56it/s] 39%|███▉      | 1952/5000 [00:05<00:08, 371.57it/s] 40%|███▉      | 1992/5000 [00:05<00:07, 378.00it/s] 41%|████      | 2031/5000 [00:05<00:07, 377.25it/s] 41%|████▏     | 2070/5000 [00:05<00:07, 379.86it/s] 42%|████▏     | 2109/5000 [00:05<00:07, 378.22it/s] 43%|████▎     | 2147/5000 [00:05<00:07, 373.06it/s] 44%|████▎     | 2185/5000 [00:06<00:09, 298.08it/s] 44%|████▍     | 2218/5000 [00:06<00:09, 297.04it/s] 45%|████▌     | 2256/5000 [00:06<00:08, 317.30it/s] 46%|████▌     | 2291/5000 [00:06<00:08, 324.31it/s] 47%|████▋     | 2328/5000 [00:06<00:07, 335.45it/s] 47%|████▋     | 2364/5000 [00:06<00:07, 342.34it/s] 48%|████▊     | 2401/5000 [00:06<00:07, 348.28it/s] 49%|████▉     | 2439/5000 [00:06<00:07, 355.08it/s] 50%|████▉     | 2476/5000 [00:06<00:07, 357.38it/s] 50%|█████     | 2512/5000 [00:07<00:06, 357.91it/s] 51%|█████     | 2549/5000 [00:07<00:06, 359.95it/s] 52%|█████▏    | 2586/5000 [00:07<00:06, 362.01it/s] 52%|█████▏    | 2624/5000 [00:07<00:06, 364.78it/s] 53%|█████▎    | 2662/5000 [00:07<00:06, 367.06it/s] 54%|█████▍    | 2702/5000 [00:07<00:06, 374.66it/s] 55%|█████▍    | 2740/5000 [00:07<00:06, 371.76it/s] 56%|█████▌    | 2778/5000 [00:07<00:05, 371.77it/s] 56%|█████▋    | 2816/5000 [00:07<00:05, 371.48it/s] 57%|█████▋    | 2854/5000 [00:07<00:05, 360.67it/s] 58%|█████▊    | 2892/5000 [00:08<00:05, 364.49it/s] 59%|█████▊    | 2930/5000 [00:08<00:05, 366.17it/s] 59%|█████▉    | 2967/5000 [00:08<00:05, 367.13it/s] 60%|██████    | 3004/5000 [00:08<00:05, 366.84it/s] 61%|██████    | 3041/5000 [00:08<00:05, 354.71it/s] 62%|██████▏   | 3081/5000 [00:08<00:05, 365.37it/s] 62%|██████▏   | 3120/5000 [00:08<00:05, 369.83it/s] 63%|██████▎   | 3159/5000 [00:08<00:04, 373.06it/s] 64%|██████▍   | 3197/5000 [00:08<00:04, 373.92it/s] 65%|██████▍   | 3235/5000 [00:08<00:04, 363.37it/s] 65%|██████▌   | 3272/5000 [00:09<00:05, 344.54it/s] 66%|██████▌   | 3307/5000 [00:09<00:05, 330.63it/s] 67%|██████▋   | 3341/5000 [00:09<00:05, 321.21it/s] 67%|██████▋   | 3374/5000 [00:09<00:05, 314.37it/s] 68%|██████▊   | 3406/5000 [00:09<00:05, 306.77it/s] 69%|██████▉   | 3438/5000 [00:09<00:05, 308.52it/s] 70%|██████▉   | 3478/5000 [00:09<00:04, 333.14it/s] 70%|███████   | 3518/5000 [00:09<00:04, 351.09it/s] 71%|███████   | 3557/5000 [00:09<00:03, 361.60it/s] 72%|███████▏  | 3597/5000 [00:10<00:03, 370.28it/s] 73%|███████▎  | 3638/5000 [00:10<00:03, 379.16it/s] 74%|███████▎  | 3677/5000 [00:10<00:03, 380.38it/s] 74%|███████▍  | 3716/5000 [00:10<00:03, 378.22it/s] 75%|███████▌  | 3754/5000 [00:10<00:03, 376.96it/s] 76%|███████▌  | 3792/5000 [00:10<00:03, 373.84it/s] 77%|███████▋  | 3830/5000 [00:10<00:03, 374.85it/s] 77%|███████▋  | 3868/5000 [00:10<00:03, 309.95it/s] 78%|███████▊  | 3901/5000 [00:10<00:03, 313.39it/s] 79%|███████▉  | 3941/5000 [00:11<00:03, 334.57it/s] 80%|███████▉  | 3978/5000 [00:11<00:02, 342.53it/s] 80%|████████  | 4016/5000 [00:11<00:02, 350.80it/s] 81%|████████  | 4054/5000 [00:11<00:02, 357.08it/s] 82%|████████▏ | 4093/5000 [00:11<00:02, 364.77it/s] 83%|████████▎ | 4131/5000 [00:11<00:02, 367.39it/s] 83%|████████▎ | 4168/5000 [00:11<00:02, 364.79it/s] 84%|████████▍ | 4205/5000 [00:11<00:02, 365.83it/s] 85%|████████▍ | 4242/5000 [00:11<00:02, 364.07it/s] 86%|████████▌ | 4279/5000 [00:12<00:02, 302.40it/s] 86%|████████▌ | 4312/5000 [00:12<00:02, 260.70it/s] 87%|████████▋ | 4351/5000 [00:12<00:02, 290.45it/s] 88%|████████▊ | 4390/5000 [00:12<00:01, 313.82it/s] 89%|████████▊ | 4427/5000 [00:12<00:01, 327.59it/s] 89%|████████▉ | 4467/5000 [00:12<00:01, 346.06it/s] 90%|█████████ | 4505/5000 [00:12<00:01, 354.70it/s] 91%|█████████ | 4544/5000 [00:12<00:01, 362.09it/s] 92%|█████████▏| 4582/5000 [00:12<00:01, 366.51it/s] 92%|█████████▏| 4620/5000 [00:13<00:01, 366.43it/s] 93%|█████████▎| 4657/5000 [00:13<00:00, 352.22it/s] 94%|█████████▍| 4694/5000 [00:13<00:00, 356.02it/s] 95%|█████████▍| 4732/5000 [00:13<00:00, 361.27it/s] 95%|█████████▌| 4769/5000 [00:13<00:00, 357.41it/s] 96%|█████████▌| 4807/5000 [00:13<00:00, 361.90it/s] 97%|█████████▋| 4844/5000 [00:13<00:00, 317.15it/s] 98%|█████████▊| 4880/5000 [00:13<00:00, 326.27it/s] 98%|█████████▊| 4918/5000 [00:13<00:00, 340.03it/s] 99%|█████████▉| 4955/5000 [00:14<00:00, 336.01it/s]100%|█████████▉| 4990/5000 [00:14<00:00, 336.98it/s]100%|██████████| 5000/5000 [00:14<00:00, 353.08it/s]
2022-08-01 18:42:26,533 INFO     Test 2i MRR at step 100000: 0.003598
2022-08-01 18:42:26,533 INFO     Test 2i HITS1 at step 100000: 0.000200
2022-08-01 18:42:26,533 INFO     Test 2i HITS3 at step 100000: 0.000600
2022-08-01 18:42:26,533 INFO     Test 2i HITS10 at step 100000: 0.003200
2022-08-01 18:42:26,533 INFO     Test 2i num_queries at step 100000: 5000.000000
2022-08-01 18:42:26,533 INFO     Test average MRR at step 100000: 0.003598
2022-08-01 18:42:26,533 INFO     Test average HITS1 at step 100000: 0.000200
2022-08-01 18:42:26,533 INFO     Test average HITS3 at step 100000: 0.000600
2022-08-01 18:42:26,533 INFO     Test average HITS10 at step 100000: 0.003200
2022-08-01 18:42:26,534 INFO     Training average positive_sample_loss at step 100000: 9399.234131
2022-08-01 18:42:26,534 INFO     Training average negative_sample_loss at step 100000: 9399.234131
2022-08-01 18:42:26,534 INFO     Training average loss at step 100000: 9399.234131
/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py:173: UserWarning: Error detected in LogSoftmaxBackward0. Traceback of forward call that caused the error:
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 543, in main
    log = KGReasoning.train_step(model, optimizer, train_other_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 712, in train_step
    loss_query_type = ce_loss(all_logit, positive_sample)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/modules/loss.py", line 1163, in forward
    return F.cross_entropy(input, target, weight=self.weight,
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/nn/functional.py", line 2996, in cross_entropy
    return torch._C._nn.cross_entropy_loss(input, target, weight, _Reduction.get_enum(reduction), ignore_index, label_smoothing)
 (Triggered internally at  ../torch/csrc/autograd/python_anomaly_mode.cpp:104.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Traceback (most recent call last):
  File "main.py", line 632, in <module>
    main(parse_args())
  File "main.py", line 543, in main
    log = KGReasoning.train_step(model, optimizer, train_other_iterator, args, step)
  File "/home/shinaliu/KG/models/kg-reasoning-alpha/models.py", line 931, in train_step
    loss.backward()
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/_tensor.py", line 363, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "/home/shinaliu/miniconda3/envs/kg/lib/python3.8/site-packages/torch/autograd/__init__.py", line 173, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'LogSoftmaxBackward0' returned nan values in its 0th output.
